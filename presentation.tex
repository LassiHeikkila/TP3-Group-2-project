%present.tex, Dan Richardson

\documentclass{beamer}
\mode<presentation>

\usepackage{graphicx}                  %use package for diagram 
\usepackage{amsmath}                   %use package for implies symbol
\usepackage{amsfonts}		       %use package for numbet sets
\usepackage{bm}                        %use package for bolds in math mode
\usepackage{tikz}                      %use package for diagram drawings
\usepackage{algpseudocode}             %use package for pseudocode
\usepackage{algorithm}                 %use package for pseudocode
\usepackage{caption}                   %use package for multiple figures
\usepackage{subcaption}                %use package for multiple figures
%\usepackage{hyperref}                  %use package for hyperlinks
%\usepackage{listings}                  %use package for c++ code in appendix
%\usepackage{colour}                    %use package for code listings
%\usepackage[utf8]{inputenc}            %use package for colours in code
%\usepackage{url}                       %use package to display urls properly
%\usepackage{array}                     %use package for centering table contents

%define colours for code listings
%\definecolor{codegreen}{rgb}{0,0.6,0}
%\definecolor{codegray}{rgb}{0.5,0.5,0.5}
%\definecolor{codepurple}{rgb}{0.58,0,0.82}
%\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

%define a style for the listings
%\lstdefinestyle{mystyle}{
%    backgroundcolor=\color{backcolour},
%    commentstyle=\color{codegreen},
%    keywordstyle=\color{magenta},
%    numberstyle=\tiny\color{codegray},
%    stringstyle=\color{codepurple},
%    basicstyle=\footnotesize,
%    breakatwhitespace=false,
%    breaklines=true,
%    captionpos=b,
%    keepspaces=true,
%    numbers=left,
%    numbersep=5pt,
%    showspaces=false,
%    showstringspaces=false,
%    showtabs=false,
%    tabsize=2
%}

%set style of listing to that defined above
%\lstset{style=mystyle}

%set style of footnotes
%\renewcommand{\thefootnote}{\roman{footnote}}

%define command shortcuts
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}

%use tikz library for shapes
\usetikzlibrary{shapes.geometric, arrows}

\title{Numerical solutions of Laplace's equation}
\author{S. Brown, F. Hayes, L. Heikkil{\"a}, W. Liu, D. Richardson\\
        School of Physics and Astronomy,\\
        University of Glasgow,\\
        Glasgow, United Kingdom}
\date{\today}

\AtBeginSection[] %layout page at start of new section
{
  \begin{frame}<beamer>
    \frametitle{Layout}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}

\begin{document} %start of document

\begin{frame} 
\titlepage
\end{frame}

\section{Introduction}

\begin{frame}{System A}

\begin{figure}[h!]
\begin{center}
\begin{tikzpicture}
\draw (0,0) node[below] {$x = -d$} -- (0,5) node[above] {$\phi = V$}; 
\draw (10,0) node[below] {$x = d$} -- (10,5) node[above] {$\phi = -V$}; 
\draw (5,2.5) circle (1cm) node[below] {$\phi=0$};
\draw[dashed] (5,2.5) -- (5.6,3.3) node[pos=0.5,above left] {$R$};
\end{tikzpicture}
\end{center}
\caption{Cross-sectional diagram of System A}
\end{figure}

\end{frame}

\begin{frame}{System C}

\begin{figure}[h!]
\begin{center}
\begin{tikzpicture}
\draw (0,0) -- (10,0) node[right] {$\phi = V$}; 
\draw (0,5) -- (10,5) node[pos=0.25, above] {GND} node[pos=0.5, above] {GND} node[pos=0.75,above] {GND}; 
\draw (2,5) rectangle (3,4.75);
\draw (4.5,5) rectangle (5.5,4.75);
\draw (7,5) rectangle (8,4.75);
\end{tikzpicture}
\end{center}
\caption{Cross-sectional diagram of System C}
\end{figure}

\end{frame}

\begin{frame}{Derivation of Laplace's Equation}
We have two of Maxwell's equations
%
\be
\nabla \cdot \bm{E} = \frac{Q}{\epsilon_0} \qquad \nabla \times \bm{E} = -\frac{\partial \bm{B}}{\partial t}
\ee

In both systems:
\begin{itemize}
\item $\bm{B}$ is unchanging $\implies$ $\bm{E}$ is irrotational $\implies \bm{E} = -\nabla \phi$
\item $Q=0$ $\implies \bm{E}$ is solenoidal $\implies \nabla^2 \phi = 0$.
\end{itemize}

This is Laplace's equation.
\end{frame}

\section{Analytical Solution}

\begin{frame}{General Solution}
Wish to solve $\nabla ^2 \phi = 0$

Separate variables, $\phi(r,\theta)=f(r)g(\theta)$, say.

Produces pair of second-order ODEs.

Solve to give general solution in polar co-ordinates:
%
\begin{multline}
\phi(r, \theta) = (\alpha_0 \ln(r) + \beta_0)(\gamma_0\theta + \delta_0) + 
\\
                + \sum_{n=1}^{\infty}(\alpha_n r^n+\beta_n r^{-n})(\gamma_n \sin(n\theta) + \delta_n \cos(n\theta))
\end{multline}
\end{frame}

\begin{frame}{Particular Solution}
We have
%
\begin{multline}
\phi(r, \theta) = (\alpha_0 \ln(r) + \beta_0)(\gamma_0\theta + \delta_0) + 
\\
                + \sum_{n=1}^{\infty}(\alpha_n r^n+\beta_n r^{-n})(\gamma_n \sin(n\theta) + \delta_n \cos(n\theta))
\end{multline}

Potential is symmetric in $\pm\theta \implies \gamma_n=0, \; \forall n$

Potential is finite at infinity $\implies \alpha_n=0, \; \forall n$

We expect $\phi(r, \theta)=\phi(r, \theta +2\pi)$, so $n \in \mathbb{Z}$ and
%
\be
\phi(r, \theta) = \beta_0 + \sum_{n=1}^{\infty} \frac{\beta_n}{r^n} \cos(n\theta)
\ee
%
where the $\beta$'s have absorbed the other constants.
\end{frame}

\begin{frame}{Particular Solution cont.}
We have
%
\be
\phi(r, \theta) = \beta_0 + \sum_{n=1}^{\infty} \frac{\beta_n}{r^n} \cos(n\theta)
\ee

As $r \rightarrow \infty$, $\phi \rightarrow -\frac{Vx}{d}=-\frac{Vr}{d}\cos(\theta)$.

Hence, $\beta_0=-\frac{Vr}{d}\cos(\theta)$, since second term vanishes.

At the surface of the cylinder $\phi(R,\theta) = 0 \implies \beta_1=\frac{VR^2}{d}$ and
$\beta_{n \geq 2} = 0$.

Final solution is:
%
\be
\phi(r, \theta) = \frac{V}{d}(\frac{R^2}{r}-r)\cos(\theta)
\ee
for $r>R$ and $0$ otherwise.

\end{frame}

\begin{frame}{Analytical Solution}

\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.8]{/home/danmfr/p3t/laplace/pdfs/analytic.pdf}
\caption{Analytic solution with $V=1$, $R=15$ on $100\times100$ grid}
\end{center}
\end{figure}

\end{frame}

\section{Numerical Solution}

\begin{frame}{Finite Difference Methods}
\end{frame}

\begin{frame}{The Relaxation Method}
\end{frame}

\begin{frame}{Numerical Solution}

\begin{figure}
\begin{center}
\includegraphics[scale=0.8]{/home/danmfr/p3t/laplace/pdfs/numerical.pdf}
\caption{Numerical potential with $V=1$, $R=15$ on $100\times100$ grid for $10000$ iterations}
\label{fig:numerical}
\end{center}
\end{figure}

\end{frame}

\section{Comparison of Analytical and Numerical Solution}

\section{Software}

\begin{frame}{Other Electrostatic Systems}
\begin{figure}
\centering
\begin{subfigure}[b]{0.45\textwidth}
	\begin{tikzpicture}
	\draw (0,0) -- (3.5,0) node[right] {$-V$};
	\draw (0,2) -- (3.5,2) node[right] {$-V$};
	\draw [draw=none](0,1) -- (3.5,1) node[right] {GND};
	\fill [fill=black] (0.5,1) circle (1mm);
	\fill [fill=black] (1,1) circle (1mm);
	\fill [fill=black] (1.5,1) circle (1mm);
	\fill [fill=black] (2,1) circle (1mm);
	\fill [fill=black] (2.5,1) circle (1mm);
	\fill [fill=black] (3,1) circle (1mm);
	\end{tikzpicture}
	\caption{System B}
\end{subfigure}
\quad
\begin{subfigure}[b]{0.45\textwidth}
	\begin{tikzpicture}
	\draw (0,0) -- (3.5,0) node[right] {GND};
	\draw (0,2) -- (3.5,2) node[right] {GND};
	\draw (0.49,0.9) rectangle (0.91,1.1) node[midway, above, font=\footnotesize] {GND};
	\draw (1.19,0.9) rectangle (1.61,1.1) node[midway, above, font=\footnotesize] {$+V$};
	\draw (1.89,0.9) rectangle (2.31,1.1) node[midway, above, font=\footnotesize] {$-V$};
	\draw (2.59,0.9) rectangle (3.01,1.1) node[midway, above, font=\footnotesize] {GND};
	\end{tikzpicture}
	\caption{System D}
\end{subfigure}

\begin{subfigure}[b]{0.45\textwidth}
	\begin{tikzpicture}
	\draw (0,0) circle (2mm) node[above, font=\footnotesize] {GND};
	\draw (1.75,0) circle (2mm) node[above, font=\footnotesize] {GND};
	\draw (3.5,0) circle (2mm) node[above, font=\footnotesize] {GND};
	\draw (0,1.6) circle (2mm) node[above, font=\footnotesize] {GND};
	\draw (1.75,1.6) circle (2mm) node[above, font=\footnotesize] {GND};
	\draw (3.5,1.6) circle (2mm) node[above, font=\footnotesize] {GND};
	\draw (0.875,0.8) circle (2mm) node[above, font=\footnotesize] {$+V$};
	\draw (2.625,0.8) circle (2mm) node[above, font=\footnotesize] {$+V$};
	\end{tikzpicture}
	\caption{System E}
\end{subfigure}
\quad
\begin{subfigure}[b]{0.45\textwidth}
	\begin{tikzpicture}
	\draw (0,0) -- (3.5,0) node[right] {GND};
	\draw (0,2) -- (3.5,2) node[right] {$-V_3$};
	\draw (0,1) -- (1.5,1);
	\draw (2,1) -- (3.5,1) node[right] {$-V_2$};
	\draw (0,0.5) -- (1.5,0.5);
	\draw (2,0.5) -- (3.5,0.5) node[right] {$-V_1$};
	\draw [fill=brown] (0,0.5) rectangle (1.5,1);
	\draw [fill=brown] (2,0.5) rectangle (3.5,1);
	\draw [draw=none] (1.75,1) circle (1mm) node[above, font=\footnotesize] {$|V_3|>|V_2|>>|V_1|$};
	\end{tikzpicture}
	\caption{System F}
\end{subfigure}

\caption{Alternate electrostatic conifgurations}
\end{figure}

\end{frame}

\begin{frame}{Bitmaps}
\end{frame}

\begin{frame}{Boolean Mask}
\end{frame}

\begin{frame}{Convergence locking}
\end{frame}

\section{Conclusion}

\begin{frame}{Conclusion}
\end{frame}

\begin{frame}
\titlepage
\end{frame}

\end{document} %end of document
